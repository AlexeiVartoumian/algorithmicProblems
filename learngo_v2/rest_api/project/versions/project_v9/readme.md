added sanitzation of user input in middlewares